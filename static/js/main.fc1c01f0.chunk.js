(this["webpackJsonpbuy-bch"]=this["webpackJsonpbuy-bch"]||[]).push([[0],{22:function(e,r,t){},37:function(e){e.exports=JSON.parse('{"order.email":"\u0412\u0430\u0448\u0438\u044f\u0442 \u0438\u043c\u0435\u0439\u043b \u0430\u0434\u0440\u0435\u0441","order.bchAddress":"\u0412\u0430\u0448\u0438\u044f\u0442 \u0411\u0438\u0442\u043a\u043e\u0439\u043d \u041a\u0435\u0448 \u0430\u0434\u0440\u0435\u0441","order.bgnAmount":"Amount of BGN you want to spend","order.bchAmount":"Estimated amount of BCH you will receive","order.termAndConditions":"I Accept <a>Terms and Conditions</a>","order.exchangeRateTerms":"I understand exchange rate is recalculated at <a>payment time</a>","order.buyButton":"BUY BCH","order.scanQr":"Scan QR Code","qrScanner.back":"Go Back","qrScanner.confirmationMessage":"Is this your BCH address?","qrScanner.submit":"yes","qrScanner.scanAgain":"scan again","phone.number":"Your Phone Number (e.g. +359888123456)","phone.smsCode":"SMS Code","phone.submit":"submit","photo.typeId":"Please upload a photo of your ID in PNG or JPEG format","photo.typeFace":"Please upload a selfie in PNG or JPEG format","photo.typeDeclaration":"Please upload a photo copy of your declaration form in PNG or JPEG format","photo.declarationUrl":"Please download your declaration form <a>here</a>","photo.upload":"upload","payment.thankYou":"Thank you for your order","payment.payHere":"Pay here","payment.newOrder":"New Order","bchapi.error.general":"Unexpected error. Please contact system administrator.","bchapi.error.notEnoughBch":"Insuffiecient BCH reserves in the service to fulfill the order. Please decrease the amount or try again later","bchapi.error.phoneNumber":"Phone number is not formed correctly. Please follow the example: +359888123456","bchapi.error.validationCode":"Validation code is invalid. Please try again.","bchapi.error.photoFormat":"Photo is of wrong format. Please try again."}')},38:function(e){e.exports=JSON.parse('{"order.email":"Your Email","order.bchAddress":"Your Bitcoin Cash Wallet Address","order.bgnAmount":"Amount of BGN you want to spend","order.bchAmount":"Estimated amount of BCH you will receive","order.termAndConditions":"I Accept <a>Terms and Conditions</a>","order.exchangeRateTerms":"I understand exchange rate is recalculated at <a>payment time</a>","order.buyButton":"BUY BCH","order.scanQr":"Scan QR Code","qrScanner.back":"Go Back","qrScanner.confirmationMessage":"Is this your BCH address?","qrScanner.submit":"yes","qrScanner.scanAgain":"try again","phone.number":"Your Phone Number (e.g. +359888123456)","phone.smsCode":"SMS Code","phone.submit":"submit","photo.typeId":"Please upload a photo of your ID in PNG or JPEG format","photo.typeFace":"Please upload a selfie in PNG or JPEG format","photo.typeDeclaration":"Please upload a photo copy of your declaration form in PNG or JPEG format","photo.declarationUrl":"Please download your declaration form <a>here</a>","photo.upload":"upload","payment.thankYou":"Thank you for your order","payment.payHere":"Pay here","payment.newOrder":"New Order","bchapi.error.general":"Unexpected error. Please contact system administrator.","bchapi.error.notEnoughBch":"Insuffiecient BCH reserves in the service to fulfill the order. Please decrease the amount or try again later","bchapi.error.phoneNumber":"Phone number is not formed correctly. Please follow the example: +359888123456","bchapi.error.validationCode":"Validation code is invalid. Please try again.","bchapi.error.photoFormat":"Photo is of wrong format. Please try again."}')},49:function(e,r,t){},68:function(e,r,t){},69:function(e,r,t){},72:function(e,r,t){},73:function(e,r,t){},81:function(e,r,t){},82:function(e,r,t){},83:function(e,r,t){},84:function(e,r,t){},85:function(e,r,t){"use strict";t.r(r);var n=t(0),a=t(1),o=t.n(a),c=t(36),s=t.n(c),i=(t(49),t(5)),u=t.n(i),d=t(8),l=t(6),b=t(15),p=t.n(b),h="https://api-stage.buybch.poype.io",f=function(){var e=Object(d.a)(u.a.mark((function e(r){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.get("".concat(h,"/rate/bchbgn?amount_bgn=").concat(r));case 3:return t=e.sent,e.abrupt("return",t.data.amount_bch);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{errorId:"bchapi.error.general"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(r){return e.apply(this,arguments)}}(),j=function(){var e=Object(d.a)(u.a.mark((function e(r){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.get("".concat(h,"/order/").concat(r));case 3:return t=e.sent,e.abrupt("return",t.data);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{errorId:"bchapi.error.general"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(r){return e.apply(this,arguments)}}(),m=function(){var e=Object(d.a)(u.a.mark((function e(r,t,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.post("".concat(h,"/order"),{bgn_amount:r,bch_addr:t,email:n});case 3:return a=e.sent,e.abrupt("return",{order:a.data});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",x(e.t0,503,"bchapi.error.notEnoughBch"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(r,t,n){return e.apply(this,arguments)}}(),O=function(){var e=Object(d.a)(u.a.mark((function e(r,t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.post("".concat(h,"/order/").concat(r,"/id/phone"),{phone:t});case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",x(e.t0,400,"bchapi.error.phoneNumber"));case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(r,t){return e.apply(this,arguments)}}(),g=function(){var e=Object(d.a)(u.a.mark((function e(r,t,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.post("".concat(h,"/order/").concat(r,"/id/phone"),{phone:t,secret_code:n});case 3:return a=e.sent,e.abrupt("return",{order:a.data});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",x(e.t0,403,"bchapi.error.validationCode"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(r,t,n){return e.apply(this,arguments)}}(),v=function(){var e=Object(d.a)(u.a.mark((function e(r,t,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.post("".concat(h,"/order/").concat(r,"/id/").concat(n),t,{headers:{"Content-Type":t.type}});case 3:return a=e.sent,e.abrupt("return",{order:a.data});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",x(e.t0,400,"bchapi.error.photoFormat"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(r,t,n){return e.apply(this,arguments)}}(),x=function(e,r,t){return{errorId:e.response&&e.response.status===r?t:"bchapi.error.general"}},y=(t(68),t(69),t(90)),S=t(37),w=t(38),C=o.a.createContext(),N=function(e){return/^bg\b/.test(e)?S:w},P=navigator.language,k=function(e){var r=Object(a.useState)(P),t=Object(l.a)(r,2),o=t[0],c=t[1],s=Object(a.useState)(N(P)),i=Object(l.a)(s,2),u=i[0],d=i[1];return Object(n.jsx)(C.Provider,{value:{locale:o,selectLanguage:function(e){c(e),d(N(e))}},children:Object(n.jsx)(y.a,{messages:u,locale:o,children:e.children})})},I=function(){var e=Object(a.useContext)(C);return Object(n.jsx)("div",{className:"header-container",children:Object(n.jsxs)("div",{className:"options-container",children:[Object(n.jsx)("div",{className:"option",onClick:function(){return e.selectLanguage("bg-BG")},children:"\u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438"}),Object(n.jsx)("div",{className:"option",onClick:function(){return e.selectLanguage("en")},children:"English"})]})})},M=t(12),A=t(18),B=(t(72),function(e){var r=e.children,t=(e.inverted,e.color),a=Object(A.a)(e,["children","inverted","color"]);return Object(n.jsx)("button",Object(M.a)(Object(M.a)({className:t?"custom-button-"+t:"custom-button"},a),{},{children:r}))}),E=(t(73),function(e){var r=e.handleChange,t=e.label,a=(e.shrink,e.children),o=Object(A.a)(e,["handleChange","label","shrink","children"]);return Object(n.jsxs)("div",{className:"group",children:[Object(n.jsx)("input",Object(M.a)({className:"form-input",onChange:r},o)),t?Object(n.jsx)("label",{className:"".concat(o.value.length?"shrink":""," form-input-label"),children:t}):null,a]})}),_=t(89),q=t(40),G=t.n(q);t(22);var T=function(e){var r=e.setBchState,t=Object(a.useState)(""),o=Object(l.a)(t,2),c=o[0],s=o[1],i=Object(a.useState)(""),u=Object(l.a)(i,2),d=u[0],b=u[1],p=Object(_.a)(),h=function(e){e.preventDefault(),r({bchAddress:c||"",showQr:!1})};return Object(n.jsxs)("div",{className:"form-container",children:[c?Object(n.jsxs)("div",{children:[Object(n.jsx)("p",{children:p.formatMessage({id:"qrScanner.confirmationMessage"})}),Object(n.jsx)("p",{children:c}),Object(n.jsxs)("div",{className:"buttons",children:[Object(n.jsx)(B,{color:"green",onClick:h,children:p.formatMessage({id:"qrScanner.submit"})}),Object(n.jsx)(B,{color:"red",onClick:function(e){e.preventDefault(),s("")},children:p.formatMessage({id:"qrScanner.scanAgain"})})]})]}):Object(n.jsxs)("div",{children:[Object(n.jsx)(G.a,{delay:300,onError:function(e){return b(e)},onScan:function(e){return s(e)},style:{margin:"10px 0px"}}),Object(n.jsx)(B,{color:"red",onClick:h,children:p.formatMessage({id:"qrScanner.back"})})]}),d?Object(n.jsx)("p",{className:"error-message",children:d}):null]})},U=(t(81),function(){return Object(n.jsx)("div",{className:"spinner-overlay",children:Object(n.jsx)("div",{className:"spinner-container"})})}),D=function(e){return function(r){var t=r.children,o=Object(A.a)(r,["children"]),c=Object(a.useState)(""),s=Object(l.a)(c,2),i=s[0],u=s[1],d=Object(a.useState)(!1),b=Object(l.a)(d,2),p=b[0],h=b[1],f=Object(_.a)();return p?Object(n.jsx)(U,{}):Object(n.jsxs)("div",{className:"form-container",children:[Object(n.jsx)(e,Object(M.a)(Object(M.a)({setErrorMessage:function(e){u(e?f.formatMessage({id:e}):"")},setLoading:h},o),{},{children:t})),i?Object(n.jsx)("p",{className:"error-message",children:i}):null]})}};t(82);var F=D((function(e){var r=e.setOrder,t=e.setErrorMessage,o=e.setLoading,c=Object(a.useState)(""),s=Object(l.a)(c,2),i=s[0],b=s[1],p=Object(a.useState)(""),h=Object(l.a)(p,2),j=h[0],O=h[1],g=Object(a.useState)({bchAddress:"",showQr:!1}),v=Object(l.a)(g,2),x=v[0],y=v[1],S=Object(a.useState)(""),w=Object(l.a)(S,2),C=w[0],N=w[1],P=Object(a.useRef)(!1),k=Object(_.a)();Object(a.useEffect)((function(){if(P.current){var e=setTimeout(Object(d.a)(u.a.mark((function e(){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(i);case 2:r=e.sent,N(r);case 4:case"end":return e.stop()}}),e)}))),1e3);return function(){return clearTimeout(e)}}P.current=!0}),[i]);var I=function(){var e=Object(d.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),o(!0),e.next=4,m(i,x.bchAddress,j);case 4:a=e.sent,o(!1),a.order?(localStorage.setItem("orderId",a.order.id),r(a.order)):a.errorId&&t(a.errorId);case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();if(x.showQr)return Object(n.jsx)(T,{setBchState:y});var A=function(e,r,t){return Object(n.jsxs)("div",{className:"group",children:[Object(n.jsx)("input",{type:"checkbox",required:!0,name:e}),Object(n.jsx)("label",{children:k.formatMessage({id:r},{a:function(e){return Object(n.jsx)("a",{href:t,children:e})}})})]})};return Object(n.jsx)("div",{children:Object(n.jsxs)("form",{onSubmit:I,children:[Object(n.jsx)(E,{name:"email",type:"email",handleChange:function(e){O(e.target.value)},value:j,label:k.formatMessage({id:"order.email"}),required:!0}),Object(n.jsx)(E,{name:"bchAddress",type:"bchAddress",handleChange:function(e){y(Object(M.a)(Object(M.a)({},x),{},{bchAddress:e.target.value}))},value:x.bchAddress,label:k.formatMessage({id:"order.bchAddress"}),required:!0,children:Object(n.jsx)("div",{className:"qr-button-container",children:Object(n.jsx)("button",{className:"custom-button qr-button",onClick:function(e){e.preventDefault(),y(Object(M.a)(Object(M.a)({},x),{},{showQr:!0}))},children:k.formatMessage({id:"order.scanQr"})})})}),Object(n.jsx)(E,{name:"bgn",type:"number",step:"1",handleChange:function(e){b(e.target.value)},value:i,label:k.formatMessage({id:"order.bgnAmount"}),required:!0,max:"9999",min:"1"}),Object(n.jsx)(E,{name:"bch",type:"text",value:C?C.toString():"",label:k.formatMessage({id:"order.bchAmount"}),readOnly:!0}),A("termsConditions","order.termAndConditions","https://api-stage.buybch.poype.io/static/terms.html"),A("exchangeRateTerms","order.exchangeRateTerms",""),Object(n.jsx)("div",{className:"buttons",children:Object(n.jsx)(B,{type:"submit",children:k.formatMessage({id:"order.buyButton"})})})]})})})),H=(t(83),function(e){var r=e.paymentUrl,t=Object(a.useReducer)((function(e){return 0===e?e+1:e-1}),0),o=Object(l.a)(t,2)[1],c=Object(_.a)();return Object(n.jsxs)("div",{className:"form-container",children:[Object(n.jsx)("p",{children:c.formatMessage({id:"payment.thankYou"})}),Object(n.jsxs)("div",{className:"buttons",children:[Object(n.jsx)(B,{onClick:function(){window.open(r,"_blank"),localStorage.setItem("new-order-button-visible",!0),setTimeout(o,1e3)},children:c.formatMessage({id:"payment.payHere"})}),localStorage.getItem("new-order-button-visible")?Object(n.jsx)(B,{onClick:function(){localStorage.clear(),window.location.reload()},children:c.formatMessage({id:"payment.newOrder"})}):null]})]})});var L=D((function(e){var r=e.orderId,t=e.setOrder,o=e.setErrorMessage,c=e.setLoading,s=Object(a.useState)(""),i=Object(l.a)(s,2),b=i[0],p=i[1],h=Object(a.useState)(""),f=Object(l.a)(h,2),j=f[0],m=f[1],v=Object(a.useState)(!1),x=Object(l.a)(v,2),y=x[0],S=x[1],w=Object(_.a)();Object(a.useEffect)((function(){var e=localStorage.getItem("phone");e&&(p(e),S(!0))}),[]);var C=function(){var e=Object(d.a)(u.a.mark((function e(n){var a,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),o(""),c(!0),!y){e.next=10;break}return e.next=6,g(r,b,j);case 6:(a=e.sent).order?(t(a.order),localStorage.removeItem("phone")):a.errorId&&(o(a.errorId),c(!1)),e.next=15;break;case 10:return e.next=12,O(r,b);case 12:(s=e.sent)?o(s.errorId):localStorage.setItem("phone",b),c(!1);case 15:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return Object(n.jsx)("div",{children:Object(n.jsxs)("form",{onSubmit:C,children:[Object(n.jsx)(E,{name:"phoneNumber",type:"text",handleChange:function(e){p(e.target.value)},value:b,label:w.formatMessage({id:"phone.number"}),required:!0}),y?Object(n.jsx)(E,{name:"validationCode",type:"text",handleChange:function(e){m(e.target.value)},value:j,label:w.formatMessage({id:"phone.smsCode"}),required:!0}):null,Object(n.jsx)("div",{className:"buttons",children:Object(n.jsx)(B,{type:"submit",children:w.formatMessage({id:"phone.submit"})})})]})})}));t(84);var J=D((function(e){var r=e.orderId,t=e.setOrder,o=e.photoSuffix,c=e.declarationFormUrl,s=e.setErrorMessage,i=e.setLoading,b=Object(a.useState)(null),p=Object(l.a)(b,2),h=p[0],f=p[1],j=Object(a.useState)(0),m=Object(l.a)(j,2),O=m[0],g=m[1],x=Object(_.a)(),y=function(){var e=Object(d.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),s(""),i(!0),e.next=5,v(r,h,o);case 5:a=e.sent,i(!1),a.order?(f(null),g(0===O?1+O:O-1),t(a.order)):a.errorId&&s(a.errorId);case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{children:[Object(n.jsx)("p",{children:x.formatMessage({id:"id_photo"===o?"photo.typeId":"face_photo"===o?"photo.typeFace":"declaration_form"===o?"photo.typeDeclaration":void 0})}),Object(n.jsxs)("form",{onSubmit:y,children:[Object(n.jsx)(E,{name:"photo",type:"file",handleChange:function(e){if(e.target.files&&e.target.files[0]){var r=e.target.files[0];f(r)}},required:!0,accept:"image/*"},O),h?Object(n.jsx)("img",{alt:"To upload",src:URL.createObjectURL(h)}):null,c?Object(n.jsx)("p",{children:x.formatMessage({id:"photo.declarationUrl"},{a:function(e){return Object(n.jsx)("a",{href:c,children:e})}})}):null,Object(n.jsx)("div",{className:"buttons",children:Object(n.jsx)(B,{type:"submit",children:x.formatMessage({id:"photo.upload"})})})]})]})}));var R=function(){var e=Object(a.useState)({}),r=Object(l.a)(e,2),t=r[0],o=r[1];return Object(a.useEffect)((function(){var e=localStorage.getItem("orderId");if(e){function r(){return(r=Object(d.a)(u.a.mark((function r(){var t;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,j(e);case 2:t=r.sent,o(t);case 4:case"end":return r.stop()}}),r)})))).apply(this,arguments)}!function(){r.apply(this,arguments)}()}}),[]),Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(I,{}),function(){if("pending_payment"===t.status)return Object(n.jsx)(H,{paymentUrl:t.payment_url});if("pending_id"===t.status){if("phone"===t.id_pending)return Object(n.jsx)(L,{orderId:t.id,setOrder:o});if("id_photo"===t.id_pending||"face_photo"===t.id_pending||"declaration_form"===t.id_pending)return Object(n.jsx)(J,{orderId:t.id,setOrder:o,photoSuffix:t.id_pending,declarationFormUrl:t.id_ext_url})}return Object(n.jsx)(F,{setOrder:o})}()]})},Q=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,91)).then((function(r){var t=r.getCLS,n=r.getFID,a=r.getFCP,o=r.getLCP,c=r.getTTFB;t(e),n(e),a(e),o(e),c(e)}))};s.a.render(Object(n.jsx)(k,{children:Object(n.jsx)(o.a.StrictMode,{children:Object(n.jsx)(R,{})})}),document.getElementById("root")),Q()}},[[85,1,2]]]);
//# sourceMappingURL=main.fc1c01f0.chunk.js.map