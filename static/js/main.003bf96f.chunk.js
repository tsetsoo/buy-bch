(this["webpackJsonpbuy-bch"]=this["webpackJsonpbuy-bch"]||[]).push([[0],{21:function(e,t,r){},37:function(e){e.exports=JSON.parse('{"order.email":"\u0412\u0430\u0448\u0438\u044f\u0442 \u0438\u043c\u0435\u0439\u043b \u0430\u0434\u0440\u0435\u0441","order.bchAddress":"\u0412\u0430\u0448\u0438\u044f\u0442 \u0411\u0438\u0442\u043a\u043e\u0439\u043d \u041a\u0435\u0448 \u0430\u0434\u0440\u0435\u0441","order.bgnAmount":"Amount of BGN you want to spend","order.bchAmount":"Estimated amount of BCH you will receive","order.termAndConditions":"I Accept <a>Terms and Conditions</a>","order.buyButton":"BUY BCH","order.scanQr":"Scan QR Code","qrScanner.confirmationMessage":"Is this your BCH address?","qrScanner.submit":"yes","qrScanner.scanAgain":"scan again","phone.number":"Your Phone Number (e.g. +359888123456)","phone.smsCode":"SMS Code","phone.submit":"submit","photo.typeId":"Please upload a photo of your ID in PNG or JPEG format","photo.typeFace":"Please upload a selfie in PNG or JPEG format","photo.typeDeclaration":"Please upload a photo copy of your declaration form in PNG or JPEG format","photo.declarationUrl":"Please download your declaration form <a>here</a>","photo.upload":"upload","payment.thankYou":"Thank you for your order","payment.payHere":"Pay here","payment.newOrder":"New Order","bchapi.error.general":"Unexpected error. Please contact system administrator.","bchapi.error.notEnoughBch":"Insuffiecient BCH reserves in the service to fulfill the order. Please decrease the amount or try again later","bchapi.error.phoneNumber":"Phone number is not formed correctly. Please follow the example: +359888123456","bchapi.error.validationCode":"Validation code is invalid. Please try again.","bchapi.error.photoFormat":"Photo is of wrong format. Please try again."}')},38:function(e){e.exports=JSON.parse('{"order.email":"Your Email","order.bchAddress":"Your Bitcoin Cash Wallet Address","order.bgnAmount":"Amount of BGN you want to spend","order.bchAmount":"Estimated amount of BCH you will receive","order.termAndConditions":"I Accept <a>Terms and Conditions</a>","order.buyButton":"BUY BCH","order.scanQr":"Scan QR Code","qrScanner.confirmationMessage":"Is this your BCH address?","qrScanner.submit":"yes","qrScanner.scanAgain":"no, scan again","phone.number":"Your Phone Number (e.g. +359888123456)","phone.smsCode":"SMS Code","phone.submit":"submit","photo.typeId":"Please upload a photo of your ID in PNG or JPEG format","photo.typeFace":"Please upload a selfie in PNG or JPEG format","photo.typeDeclaration":"Please upload a photo copy of your declaration form in PNG or JPEG format","photo.declarationUrl":"Please download your declaration form <a>here</a>","photo.upload":"upload","payment.thankYou":"Thank you for your order","payment.payHere":"Pay here","payment.newOrder":"New Order","bchapi.error.general":"Unexpected error. Please contact system administrator.","bchapi.error.notEnoughBch":"Insuffiecient BCH reserves in the service to fulfill the order. Please decrease the amount or try again later","bchapi.error.phoneNumber":"Phone number is not formed correctly. Please follow the example: +359888123456","bchapi.error.validationCode":"Validation code is invalid. Please try again.","bchapi.error.photoFormat":"Photo is of wrong format. Please try again."}')},49:function(e,t,r){},68:function(e,t,r){},69:function(e,t,r){},72:function(e,t,r){},73:function(e,t,r){},74:function(e,t,r){},82:function(e,t,r){},83:function(e,t,r){},84:function(e,t,r){},86:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(1),o=r.n(a),c=r(36),s=r.n(c),i=(r(49),r(5)),u=r.n(i),d=r(8),l=r(6),b=r(15),p=r.n(b),h="https://api-stage.buybch.poype.io/",f=function(){var e=Object(d.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.get("".concat(h,"/rate/bchbgn?amount_bgn=").concat(t));case 3:return r=e.sent,e.abrupt("return",r.data.amount_bch);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{errorId:"bchapi.error.general"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(d.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.get("".concat(h,"/order/").concat(t));case 3:return r=e.sent,e.abrupt("return",r.data);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{errorId:"bchapi.error.general"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(d.a)(u.a.mark((function e(t,r,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.post("".concat(h,"/order"),{bgn_amount:t,bch_addr:r,email:n});case 3:return a=e.sent,e.abrupt("return",{order:a.data});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",x(e.t0,503,"bchapi.error.notEnoughBch"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n){return e.apply(this,arguments)}}(),O=function(){var e=Object(d.a)(u.a.mark((function e(t,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.post("".concat(h,"/order/").concat(t,"/id/phone"),{phone:r});case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",x(e.t0,400,"bchapi.error.phoneNumber"));case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,r){return e.apply(this,arguments)}}(),v=function(){var e=Object(d.a)(u.a.mark((function e(t,r,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.post("".concat(h,"/order/").concat(t,"/id/phone"),{phone:r,secret_code:n});case 3:return a=e.sent,e.abrupt("return",{order:a.data});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",x(e.t0,403,"bchapi.error.validationCode"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n){return e.apply(this,arguments)}}(),g=function(){var e=Object(d.a)(u.a.mark((function e(t,r,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.post("".concat(h,"/order/").concat(t,"/id/").concat(n),r,{headers:{"Content-Type":r.type}});case 3:return a=e.sent,e.abrupt("return",{order:a.data});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",x(e.t0,400,"bchapi.error.photoFormat"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n){return e.apply(this,arguments)}}(),x=function(e,t,r){return{errorId:e.response&&e.response.status===t?r:"bchapi.error.general"}},y=(r(68),r(69),r(90)),S=r(37),w=r(38),C=o.a.createContext(),N=function(e){return/^bg\b/.test(e)?S:w},P=navigator.language,k=function(e){var t=Object(a.useState)(P),r=Object(l.a)(t,2),o=r[0],c=r[1],s=Object(a.useState)(N(P)),i=Object(l.a)(s,2),u=i[0],d=i[1];return Object(n.jsx)(C.Provider,{value:{locale:o,selectLanguage:function(e){c(e),d(N(e))}},children:Object(n.jsx)(y.a,{messages:u,locale:o,children:e.children})})},I=function(){var e=Object(a.useContext)(C);return Object(n.jsx)("div",{className:"header-container",children:Object(n.jsxs)("div",{className:"options-container",children:[Object(n.jsx)("div",{className:"option",onClick:function(){return e.selectLanguage("bg-BG")},children:"\u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438"}),Object(n.jsx)("div",{className:"option",onClick:function(){return e.selectLanguage("en")},children:"English"})]})})},M=r(12),A=r(24),B=(r(72),function(e){var t=e.children,r=(e.inverted,Object(A.a)(e,["children","inverted"]));return Object(n.jsx)("button",Object(M.a)(Object(M.a)({className:"custom-button"},r),{},{children:t}))}),_=(r(73),function(e){var t=e.handleChange,r=e.label,a=(e.shrink,e.children),o=Object(A.a)(e,["handleChange","label","shrink","children"]);return Object(n.jsxs)("div",{className:"group",children:[Object(n.jsx)("input",Object(M.a)({className:"form-input",onChange:t},o)),r?Object(n.jsx)("label",{className:"".concat(o.value.length?"shrink":""," form-input-label"),children:r}):null,a]})}),q=(r(74),function(){return Object(n.jsx)("div",{className:"spinner-overlay",children:Object(n.jsx)("div",{className:"spinner-container"})})}),E=r(89),G=r(40),U=r.n(G);r(21);var D=function(e){var t=e.setBchState,r=Object(a.useState)(null),o=Object(l.a)(r,2),c=o[0],s=o[1],i=Object(a.useState)(""),u=Object(l.a)(i,2),d=u[0],b=u[1],p=Object(E.a)();return Object(n.jsxs)("div",{className:"form-container",children:[c?Object(n.jsxs)("div",{children:[Object(n.jsx)("p",{children:p.formatMessage({id:"qrScanner.confirmationMessage"})}),Object(n.jsx)("p",{children:c}),Object(n.jsxs)("div",{className:"buttons",children:[Object(n.jsx)(B,{onClick:function(e){e.preventDefault(),t({bchAddress:c,showQr:!1})},children:p.formatMessage({id:"qrScanner.submit"})}),Object(n.jsx)(B,{onClick:function(e){e.preventDefault(),s("")},children:p.formatMessage({id:"qrScanner.scanAgain"})})]})]}):Object(n.jsx)(U.a,{delay:300,onError:function(e){return b(e)},onScan:function(e){return s(e)}}),d?Object(n.jsx)("p",{className:"error-message",children:d}):null]})};r(82);var F=function(e){var t=e.setOrder,r=Object(a.useState)(""),o=Object(l.a)(r,2),c=o[0],s=o[1],i=Object(a.useState)(""),b=Object(l.a)(i,2),p=b[0],h=b[1],j=Object(a.useState)({bchAddress:"",showQr:!1}),O=Object(l.a)(j,2),v=O[0],g=O[1],x=Object(a.useState)(""),y=Object(l.a)(x,2),S=y[0],w=y[1],C=Object(a.useState)(""),N=Object(l.a)(C,2),P=N[0],k=N[1],I=Object(a.useState)(!1),A=Object(l.a)(I,2),G=A[0],U=A[1],F=Object(a.useRef)(!1),H=Object(E.a)();Object(a.useEffect)((function(){if(F.current){var e=setTimeout(Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(c);case 2:t=e.sent,w(t);case 4:case"end":return e.stop()}}),e)}))),1e3);return function(){return clearTimeout(e)}}F.current=!0}),[c]);var T=function(){var e=Object(d.a)(u.a.mark((function e(r){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),U(!0),e.next=4,m(c,v.bchAddress,p);case 4:n=e.sent,U(!1),n.order?(localStorage.setItem("orderId",n.order.id),t(n.order)):n.errorId&&k(H.formatMessage({id:n.errorId}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return G?Object(n.jsx)(q,{}):v.showQr?Object(n.jsx)(D,{setBchState:g}):Object(n.jsxs)("div",{className:"form-container",children:[Object(n.jsxs)("form",{onSubmit:T,children:[Object(n.jsx)(_,{name:"email",type:"email",handleChange:function(e){h(e.target.value)},value:p,label:H.formatMessage({id:"order.email"}),required:!0}),Object(n.jsx)(_,{name:"bchAddress",type:"bchAddress",handleChange:function(e){g(Object(M.a)(Object(M.a)({},v),{},{bchAddress:e.target.value}))},value:v.bchAddress,label:H.formatMessage({id:"order.bchAddress"}),required:!0,children:Object(n.jsx)("div",{className:"qr-button-container",children:Object(n.jsx)("button",{className:"custom-button qr-button",onClick:function(e){e.preventDefault(),g(Object(M.a)(Object(M.a)({},v),{},{showQr:!0}))},children:H.formatMessage({id:"order.scanQr"})})})}),Object(n.jsx)(_,{name:"bgn",type:"number",step:"1",handleChange:function(e){s(e.target.value)},value:c,label:H.formatMessage({id:"order.bgnAmount"}),required:!0,max:"9999",min:"1"}),Object(n.jsx)(_,{name:"bch",type:"text",value:S?S.toString():"",label:H.formatMessage({id:"order.bchAmount"}),readOnly:!0}),Object(n.jsxs)("div",{className:"group",children:[Object(n.jsx)("input",{type:"checkbox",required:!0,name:"termsConditions"}),Object(n.jsx)("label",{children:H.formatMessage({id:"order.termAndConditions"},{a:function(e){return Object(n.jsx)("a",{href:"",children:e})}})})]}),Object(n.jsx)("div",{className:"buttons",children:Object(n.jsx)(B,{type:"submit",children:H.formatMessage({id:"order.buyButton"})})})]}),P?Object(n.jsx)("p",{className:"error-message",children:P}):null]})},H=(r(83),function(e){var t=e.paymentUrl,r=Object(a.useReducer)((function(e){return 0===e?e+1:e-1}),0),o=Object(l.a)(r,2)[1],c=Object(E.a)();return Object(n.jsxs)("div",{className:"form-container",children:[Object(n.jsx)("p",{children:c.formatMessage({id:"payment.thankYou"})}),Object(n.jsxs)("div",{className:"buttons",children:[Object(n.jsx)(B,{onClick:function(){window.open(t,"_blank"),localStorage.setItem("new-order-button-visible",!0),setTimeout(o,1e3)},children:c.formatMessage({id:"payment.payHere"})}),localStorage.getItem("new-order-button-visible")?Object(n.jsx)(B,{onClick:function(){localStorage.clear(),window.location.reload()},children:c.formatMessage({id:"payment.newOrder"})}):null]})]})});var T=function(e){var t=e.orderId,r=e.setOrder,o=Object(a.useState)(""),c=Object(l.a)(o,2),s=c[0],i=c[1],b=Object(a.useState)(""),p=Object(l.a)(b,2),h=p[0],f=p[1],j=Object(a.useState)(!1),m=Object(l.a)(j,2),g=m[0],x=m[1],y=Object(a.useState)(""),S=Object(l.a)(y,2),w=S[0],C=S[1],N=Object(E.a)(),P=function(){var e=Object(d.a)(u.a.mark((function e(n){var a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),C(""),!g){e.next=9;break}return e.next=5,v(t,s,h);case 5:(a=e.sent).order?r(a.order):a.errorId&&C(N.formatMessage({id:a.errorId})),e.next=13;break;case 9:return e.next=11,O(t,s);case 11:(o=e.sent)?C(N.formatMessage({id:o.errorId})):x(!g);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{className:"form-container",children:[Object(n.jsxs)("form",{onSubmit:P,children:[Object(n.jsx)(_,{name:"phoneNumber",type:"text",handleChange:function(e){i(e.target.value)},value:s,label:N.formatMessage({id:"phone.number"}),required:!0}),g?Object(n.jsx)(_,{name:"validationCode",type:"text",handleChange:function(e){f(e.target.value)},value:h,label:N.formatMessage({id:"phone.smsCode"}),required:!0}):null,Object(n.jsx)("div",{className:"buttons",children:Object(n.jsx)(B,{type:"submit",children:N.formatMessage({id:"phone.submit"})})})]}),w?Object(n.jsx)("p",{className:"error-message",children:w}):null]})};r(84);var J=function(e){var t=e.orderId,r=e.setOrder,o=e.photoSuffix,c=e.declarationFormUrl,s=Object(a.useState)(null),i=Object(l.a)(s,2),b=i[0],p=i[1],h=Object(a.useState)(0),f=Object(l.a)(h,2),j=f[0],m=f[1],O=Object(a.useState)(""),v=Object(l.a)(O,2),x=v[0],y=v[1],S=Object(E.a)(),w=function(){var e=Object(d.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),y(""),e.next=4,g(t,b,o);case 4:(a=e.sent).order?(p(null),m(0===j?1+j:j-1),r(a.order)):a.errorId&&y(S.formatMessage({id:a.errorId}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{className:"form-container",children:[Object(n.jsx)("p",{children:S.formatMessage({id:"id_photo"===o?"photo.typeId":"face_photo"===o?"photo.typeFace":"declaration_form"===o?"photo.typeDeclaration":void 0})}),Object(n.jsxs)("form",{onSubmit:w,children:[Object(n.jsx)(_,{name:"photo",type:"file",handleChange:function(e){if(e.target.files&&e.target.files[0]){var t=e.target.files[0];p(t)}},required:!0},j),b?Object(n.jsx)("img",{alt:"To upload",src:URL.createObjectURL(b)}):null,c?Object(n.jsx)("p",{children:S.formatMessage({id:"photo.declarationUrl"},{a:function(e){return Object(n.jsx)("a",{href:c,children:e})}})}):null,Object(n.jsx)("div",{className:"buttons",children:Object(n.jsx)(B,{type:"submit",children:S.formatMessage({id:"photo.upload"})})})]}),x?Object(n.jsx)("p",{className:"error-message",children:x}):null]})};var Q=function(){var e=Object(a.useState)({}),t=Object(l.a)(e,2),r=t[0],o=t[1];return Object(a.useEffect)((function(){var e=localStorage.getItem("orderId");if(e){function t(){return(t=Object(d.a)(u.a.mark((function t(){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j(e);case 2:r=t.sent,console.log(r),o(r);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}}),[]),Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(I,{}),function(){if("pending_payment"===r.status)return Object(n.jsx)(H,{paymentUrl:r.payment_url});if("pending_id"===r.status){if("phone"===r.id_pending)return Object(n.jsx)(T,{orderId:r.id,setOrder:o});if("id_photo"===r.id_pending||"face_photo"===r.id_pending||"declaration_form"===r.id_pending)return Object(n.jsx)(J,{orderId:r.id,setOrder:o,photoSuffix:r.id_pending,declarationFormUrl:r.id_ext_url})}return Object(n.jsx)(F,{setOrder:o})}()]})},Y=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,91)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,o=t.getLCP,c=t.getTTFB;r(e),n(e),a(e),o(e),c(e)}))};s.a.render(Object(n.jsx)(k,{children:Object(n.jsx)(o.a.StrictMode,{children:Object(n.jsx)(Q,{})})}),document.getElementById("root")),Y()}},[[86,1,2]]]);
//# sourceMappingURL=main.003bf96f.chunk.js.map